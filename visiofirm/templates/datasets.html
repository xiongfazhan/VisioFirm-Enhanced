{% extends "labeler_base.html" %}
{% block title %}æ•°æ®é›†ç®¡ç†{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/datasets.css') }}">
{% endblock %}

{% block content %}
    <div class="dataset-container">
        <!-- Header -->
        <div class="dataset-header">
            <h1 class="dataset-title">æ•°æ®é›†ç®¡ç†</h1>
            <div class="dataset-actions">
                <button class="btn btn-secondary">
                    <span>ğŸ“¥</span> ä¸‹è½½æ•°æ®é›†
                </button>
                <button class="btn btn-primary">
                    <span>â•</span> åˆ›å»ºæ•°æ®é›†
                </button>
            </div>
        </div>
        
        <!-- Controls -->
        <div class="dataset-controls">
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" 
                       placeholder="æœç´¢æ•°æ®é›†åç§°æˆ–æè¿°...">
                <button class="search-btn">ğŸ”</button>
            </div>
            <select class="filter-select" id="typeFilter">
                <option value="">æ‰€æœ‰ç±»å‹</option>
                <option value="custom">è‡ªå®šä¹‰</option>
                <option value="downloaded">ä¸‹è½½</option>
                <option value="imported">å¯¼å…¥</option>
            </select>
        </div>
        
        <!-- Dataset Grid -->
        <div id="datasetGrid" class="dataset-grid">
            <div class="loading">æ­£åœ¨åŠ è½½æ•°æ®é›†...</div>
        </div>
        
        <!-- Pagination -->
        <div id="pagination" class="pagination" style="display: none;">
            <!-- Pagination will be populated by JavaScript -->
        </div>
    </div>
    
    <!-- Download Modal -->
    <div id="downloadModal" class="modal">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h2 class="modal-title">ä¸‹è½½å¼€æºæ•°æ®é›†</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- ä¸‹è½½æ–¹å¼é€‰æ‹© -->
                <div class="download-tabs">
                    <button class="tab-btn active">æ‰‹åŠ¨è¾“å…¥</button>
                    <button class="tab-btn">æœç´¢æ•°æ®é›†</button>
                    <button class="tab-btn">çƒ­é—¨æ•°æ®é›†</button>
                </div>
                
                <!-- æ‰‹åŠ¨è¾“å…¥æ–¹å¼ -->
                <div id="manualTab" class="download-tab-content active">
                <form class="download-form" onsubmit="startDownload(event)">
                    <div class="form-group">
                        <label class="form-label">æ•°æ®é›†URL *</label>
                        <input type="url" class="form-input" id="downloadUrl" 
                               placeholder="https://example.com/dataset.zip" required>
                            <small class="form-hint">æ”¯æŒ .zip, .tar, .tar.gz, .rar æ ¼å¼</small>
                    </div>
                    <div class="form-group">
                        <label class="form-label">æ•°æ®é›†åç§° *</label>
                        <input type="text" class="form-input" id="downloadName" 
                               placeholder="è¾“å…¥æ•°æ®é›†åç§°" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">æè¿°</label>
                        <textarea class="form-input form-textarea" id="downloadDescription" 
                                  placeholder="æ•°æ®é›†æè¿°ï¼ˆå¯é€‰ï¼‰"></textarea>
                    </div>
                    </form>
                </div>
                
                <!-- æœç´¢æ–¹å¼ -->
                <div id="searchTab" class="download-tab-content">
                    <div class="search-section">
                        <div class="search-box">
                            <input type="text" class="search-input" id="datasetSearch" 
                                   placeholder="æœç´¢æ•°æ®é›†åç§°æˆ–å…³é”®è¯...">
                            <button class="search-btn">ğŸ”</button>
                        </div>
                        <select class="filter-select" id="sourceFilter">
                            <option value="all">æ‰€æœ‰æ¥æº</option>
                            <option value="kaggle">Kaggle</option>
                            <option value="github">GitHub</option>
                            <option value="huggingface">HuggingFace</option>
                        </select>
                    </div>
                    <div id="searchResults" class="search-results">
                        <!-- æœç´¢ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                    </div>
                </div>
                
                <!-- çƒ­é—¨æ•°æ®é›† -->
                <div id="popularTab" class="download-tab-content">
                    <div class="popular-datasets">
                        <div class="dataset-card">
                            <h4>COCOæ•°æ®é›†</h4>
                            <p>Microsoft Common Objects in Context</p>
                            <span class="dataset-size">~18GB</span>
                        </div>
                        <div class="dataset-card">
                            <h4>ImageNet</h4>
                            <p>å¤§è§„æ¨¡å›¾åƒåˆ†ç±»æ•°æ®é›†</p>
                            <span class="dataset-size">~150GB</span>
                        </div>
                        <div class="dataset-card">
                            <h4>Pascal VOC</h4>
                            <p>Pascal Visual Object Classes</p>
                            <span class="dataset-size">~2GB</span>
                        </div>
                        <div class="dataset-card">
                            <h4>Open Images</h4>
                            <p>Googleå¼€æºå›¾åƒæ•°æ®é›†</p>
                            <span class="dataset-size">~500GB</span>
                        </div>
                    </div>
                </div>
                
                <!-- ä¸‹è½½è¿›åº¦ -->
                <div class="progress-container" id="progressContainer" style="display: none;">
                    <div class="progress-header">
                        <span id="progressTitle">ä¸‹è½½è¿›åº¦</span>
                        <button class="cancel-btn" id="cancelBtn">å–æ¶ˆä¸‹è½½</button>
                    </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    <div class="progress-details">
                        <div class="progress-text" id="progressText">å‡†å¤‡ä¸‹è½½...</div>
                        <div class="progress-stats" id="progressStats"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary">å–æ¶ˆ</button>
                <button type="button" class="btn btn-primary" id="downloadBtn">å¼€å§‹ä¸‹è½½</button>
            </div>
        </div>
    </div>
    
    <!-- Dataset Detail Modal -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="detailTitle">æ•°æ®é›†è¯¦æƒ…</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="detailBody">
                <!-- Detail content will be populated by JavaScript -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary">å…³é—­</button>
                <button type="button" class="btn btn-primary" id="linkProjectBtn">å…³è”é¡¹ç›®</button>
            </div>
        </div>
    </div>

{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/datasetManager.js') }}"></script>
    <script src="{{ url_for('static', filename='js/datasetDownloader.js') }}"></script>
<script src="{{ url_for('static', filename='js/datasets.js') }}"></script>
{% endblock %}
