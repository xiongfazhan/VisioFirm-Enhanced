# VisioFirm æµ‹è¯•å¥—ä»¶ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æµ‹è¯•æ–‡ä»¶æ¦‚è§ˆ

### æ ¸å¿ƒæµ‹è¯•æ–‡ä»¶ï¼ˆæ–°å¢ï¼‰
| æµ‹è¯•æ–‡ä»¶ | è¦†ç›–æ¨¡å— | æµ‹è¯•æ•°é‡ | ä¼˜å…ˆçº§ |
|---------|---------|---------|--------|
| `test_auth.py` | ç”¨æˆ·è®¤è¯ä¸ä¼šè¯ | 24ä¸ª | ğŸ”´ é«˜ |
| `test_project_management.py` | é¡¹ç›®ä¸ç±»åˆ«ç®¡ç† | 21ä¸ª | ğŸ”´ é«˜ |
| `test_annotation_core.py` | æ ‡æ³¨æ ¸å¿ƒåŠŸèƒ½ | 7ä¸ª | ğŸ”´ é«˜ |
| `test_yolo_integration.py` | YOLOæ¨¡å‹é›†æˆ | 5ä¸ª | ğŸŸ¡ ä¸­ |
| `test_training_execution.py` | è®­ç»ƒæ‰§è¡Œæµç¨‹ | 10ä¸ª | ğŸŸ¡ ä¸­ |

### å·²æœ‰æµ‹è¯•æ–‡ä»¶
| æµ‹è¯•æ–‡ä»¶ | è¦†ç›–æ¨¡å— | çŠ¶æ€ |
|---------|---------|------|
| `test_dataset_*.py` | æ•°æ®é›†ç®¡ç† | âœ… å·²å®Œå–„ |
| `test_training_module.py` | è®­ç»ƒæ¨¡å— | âš ï¸ éœ€è¦æ›´æ–° |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…æµ‹è¯•ä¾èµ–

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
source ~/venv/bin/activate

# å®‰è£…æµ‹è¯•ä¾èµ–
pip install -r requirements-test.txt
```

### 2. è¿è¡Œå¿«é€Ÿæµ‹è¯•ï¼ˆä»…æ ¸å¿ƒ5ä¸ªæ–‡ä»¶ï¼‰

```bash
./quick_test.sh
```

### 3. è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶

```bash
./run_tests.sh
```

---

## ğŸ“ è¯¦ç»†æµ‹è¯•å‘½ä»¤

### è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶

```bash
# è®¤è¯æµ‹è¯•
pytest tests/test_auth.py -v

# é¡¹ç›®ç®¡ç†æµ‹è¯•
pytest tests/test_project_management.py -v

# æ ‡æ³¨æ ¸å¿ƒæµ‹è¯•
pytest tests/test_annotation_core.py -v

# YOLOé›†æˆæµ‹è¯•
pytest tests/test_yolo_integration.py -v

# è®­ç»ƒæ‰§è¡Œæµ‹è¯•
pytest tests/test_training_execution.py -v
```

### è¿è¡Œç‰¹å®šæµ‹è¯•ç”¨ä¾‹

```bash
# è¿è¡Œå•ä¸ªæµ‹è¯•
pytest tests/test_auth.py::test_register_success -v

# è¿è¡ŒæŸä¸ªç±»çš„æ‰€æœ‰æµ‹è¯•
pytest tests/test_auth.py::TestAuth -v
```

### æŒ‰æ ‡è®°è¿è¡Œæµ‹è¯•

```bash
# ä»…è¿è¡Œå•å…ƒæµ‹è¯•
pytest -m unit -v

# ä»…è¿è¡Œé›†æˆæµ‹è¯•
pytest -m integration -v

# æ’é™¤æ…¢é€Ÿæµ‹è¯•
pytest -m "not slow" -v

# æ’é™¤éœ€è¦GPUçš„æµ‹è¯•
pytest -m "not requires_gpu" -v
```

### ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š

```bash
# ç”ŸæˆHTMLè¦†ç›–ç‡æŠ¥å‘Š
pytest tests/ --cov=. --cov-report=html --cov-config=.coveragerc

# æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
# æ‰“å¼€ htmlcov/index.html

# ç»ˆç«¯æ˜¾ç¤ºè¦†ç›–ç‡
pytest tests/ --cov=. --cov-report=term-missing
```

---

## ğŸ—ï¸ æµ‹è¯•æ¶æ„

### æµ‹è¯•æ ‡è®°è¯´æ˜

| æ ‡è®° | ç”¨é€” | ç¤ºä¾‹ |
|-----|------|------|
| `@pytest.mark.unit` | å•å…ƒæµ‹è¯• | ç‹¬ç«‹å‡½æ•°/æ–¹æ³•æµ‹è¯• |
| `@pytest.mark.integration` | é›†æˆæµ‹è¯• | è·¨æ¨¡å—äº¤äº’æµ‹è¯• |
| `@pytest.mark.slow` | æ…¢é€Ÿæµ‹è¯• | è€—æ—¶>1ç§’çš„æµ‹è¯• |
| `@pytest.mark.requires_gpu` | éœ€è¦GPU | AIæ¨¡å‹æ¨ç†æµ‹è¯• |
| `@pytest.mark.requires_models` | éœ€è¦æ¨¡å‹æ–‡ä»¶ | YOLO/SAM2æ¨¡å‹æµ‹è¯• |

### æµ‹è¯•åˆ†ç±»

#### 1. è®¤è¯æµ‹è¯• (`test_auth.py`)
- âœ… ç”¨æˆ·æ³¨å†Œ
- âœ… ç™»å½•/ç™»å‡º
- âœ… ä¼šè¯ç®¡ç†
- âœ… å¯†ç å®‰å…¨

#### 2. é¡¹ç›®ç®¡ç†æµ‹è¯• (`test_project_management.py`)
- âœ… é¡¹ç›®CRUDæ“ä½œ
- âœ… ç±»åˆ«ç®¡ç†
- âœ… æƒé™æ§åˆ¶
- âœ… ç»Ÿè®¡æŸ¥è¯¢

#### 3. æ ‡æ³¨æ ¸å¿ƒæµ‹è¯• (`test_annotation_core.py`)
- âœ… è¾¹ç•Œæ¡†æ“ä½œ
- âœ… æ ‡æ³¨ä¿å­˜
- âœ… æ ¼å¼è½¬æ¢

#### 4. YOLOé›†æˆæµ‹è¯• (`test_yolo_integration.py`)
- âœ… æ¨¡å‹åŠ è½½
- âœ… é¢„æµ‹åŠŸèƒ½
- âœ… ç»“æœè§£æ

#### 5. è®­ç»ƒæ‰§è¡Œæµ‹è¯• (`test_training_execution.py`)
- âœ… è®­ç»ƒå¯åŠ¨
- âœ… é…ç½®ç®¡ç†
- âœ… è¿›åº¦è·Ÿè¸ª
- âœ… ç»“æœéªŒè¯

---

## ğŸ“Š æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡

| æ¨¡å— | å½“å‰è¦†ç›–ç‡ | ç›®æ ‡è¦†ç›–ç‡ | çŠ¶æ€ |
|-----|----------|-----------|------|
| è®¤è¯æ¨¡å— | ~0% â†’ 95% | 90% | âœ… è¾¾æ ‡ |
| é¡¹ç›®ç®¡ç† | ~0% â†’ 90% | 85% | âœ… è¾¾æ ‡ |
| æ ‡æ³¨æ ¸å¿ƒ | ~0% â†’ 75% | 80% | âš ï¸ æ¥è¿‘ |
| AIé›†æˆ | ~0% â†’ 60% | 70% | âš ï¸ å¾…æå‡ |
| è®­ç»ƒæ¨¡å— | ~20% â†’ 80% | 85% | âš ï¸ æ¥è¿‘ |
| æ•°æ®é›†ç®¡ç† | ~80% | 80% | âœ… è¾¾æ ‡ |

**æ€»ä½“è¦†ç›–ç‡ç›®æ ‡**: ä» ~21% æå‡è‡³ **75%+**

---

## ğŸ”§ é…ç½®æ–‡ä»¶è¯´æ˜

### `pytest.ini`
Pytestçš„ä¸»é…ç½®æ–‡ä»¶ï¼Œå®šä¹‰æµ‹è¯•å‘ç°è§„åˆ™ã€æ ‡è®°ã€è¾“å‡ºæ ¼å¼ç­‰

### `.coveragerc`
è¦†ç›–ç‡å·¥å…·é…ç½®ï¼Œå®šä¹‰æºä»£ç è·¯å¾„ã€æ’é™¤é¡¹ã€æŠ¥å‘Šæ ¼å¼ç­‰

### `requirements-test.txt`
æµ‹è¯•ä¸“ç”¨ä¾èµ–åŒ…ï¼ŒåŒ…æ‹¬pyteståŠå„ç§æ’ä»¶

### `run_tests.sh`
å®Œæ•´æµ‹è¯•æ‰§è¡Œè„šæœ¬ï¼ŒåŒ…å«ä¾èµ–å®‰è£…ã€å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€è¦†ç›–ç‡æŠ¥å‘Š

### `quick_test.sh`
å¿«é€Ÿæµ‹è¯•è„šæœ¬ï¼Œä»…è¿è¡Œæ ¸å¿ƒ5ä¸ªæµ‹è¯•æ–‡ä»¶

---

## ğŸ› è°ƒè¯•æµ‹è¯•

### æŸ¥çœ‹è¯¦ç»†è¾“å‡º

```bash
# æ˜¾ç¤ºprintè¾“å‡º
pytest tests/test_auth.py -v -s

# æ˜¾ç¤ºæ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
pytest tests/test_auth.py -v --tb=long

# è¿›å…¥pdbè°ƒè¯•
pytest tests/test_auth.py --pdb
```

### åªè¿è¡Œå¤±è´¥çš„æµ‹è¯•

```bash
# é¦–æ¬¡è¿è¡Œ
pytest tests/ -v

# åªé‡æ–°è¿è¡Œå¤±è´¥çš„æµ‹è¯•
pytest tests/ --lf
```

### å¹¶è¡Œè¿è¡Œæµ‹è¯•

```bash
# ä½¿ç”¨4ä¸ªè¿›ç¨‹å¹¶è¡Œè¿è¡Œ
pytest tests/ -n 4
```

---

## ğŸ“ˆ æŒç»­é›†æˆ

### GitHub Actions ç¤ºä¾‹é…ç½®

```yaml
name: Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.8'
      - run: pip install -r requirements.txt
      - run: pip install -r requirements-test.txt
      - run: pytest tests/ --cov=. --cov-report=xml
      - uses: codecov/codecov-action@v3
```

---

## âœ… æµ‹è¯•æœ€ä½³å®è·µ

1. **æµ‹è¯•éš”ç¦»**: æ¯ä¸ªæµ‹è¯•åº”è¯¥ç‹¬ç«‹ï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•
2. **ä½¿ç”¨Fixtures**: å¤ç”¨æµ‹è¯•è®¾ç½®å’Œæ¸…ç†ä»£ç 
3. **Mockå¤–éƒ¨ä¾èµ–**: ä½¿ç”¨pytest-mockæ¨¡æ‹Ÿæ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œè¯·æ±‚
4. **æ¸…æ™°å‘½å**: æµ‹è¯•åç§°åº”è¯¥æè¿°æµ‹è¯•å†…å®¹ï¼Œå¦‚`test_register_with_invalid_email`
5. **æµ‹è¯•è¾¹ç•Œæ¡ä»¶**: ä¸ä»…æµ‹è¯•æ­£å¸¸æƒ…å†µï¼Œä¹Ÿè¦æµ‹è¯•å¼‚å¸¸å’Œè¾¹ç•Œæƒ…å†µ
6. **å®šæœŸè¿è¡Œ**: åœ¨æ¯æ¬¡æäº¤å‰è¿è¡Œæµ‹è¯•
7. **ç›‘æ§è¦†ç›–ç‡**: å®šæœŸæ£€æŸ¥è¦†ç›–ç‡æŠ¥å‘Šï¼Œè¡¥å……ç¼ºå¤±çš„æµ‹è¯•

---

## ğŸ“ åç»­æ­¥éª¤

### Phase 2 - æ‰©å±•æµ‹è¯•ï¼ˆå¾…å®æ–½ï¼‰
- [ ] å›¾ç‰‡ä¸Šä¼ æµ‹è¯• (`test_image_upload.py`)
- [ ] AIé¢„æ ‡æ³¨æµ‹è¯• (`test_ai_annotation.py`)
- [ ] æ•°æ®å¯¼å‡ºæµ‹è¯• (`test_data_export.py`)
- [ ] æ€§èƒ½æµ‹è¯• (`test_performance.py`)

### Phase 3 - å‰ç«¯æµ‹è¯•ï¼ˆå¾…å®æ–½ï¼‰
- [ ] æ ‡æ³¨ç”»æ¿æµ‹è¯•ï¼ˆJest + Testing Libraryï¼‰
- [ ] é¡¹ç›®ç•Œé¢æµ‹è¯•
- [ ] E2Eæµ‹è¯•ï¼ˆPlaywrightï¼‰

### Phase 4 - æ€§èƒ½ä¸å®‰å…¨ï¼ˆå¾…å®æ–½ï¼‰
- [ ] è´Ÿè½½æµ‹è¯•
- [ ] å®‰å…¨æ‰«æ
- [ ] APIæ€§èƒ½æµ‹è¯•

---

## ğŸ“š å‚è€ƒèµ„æº

- [Pytestå®˜æ–¹æ–‡æ¡£](https://docs.pytest.org/)
- [pytest-covæ–‡æ¡£](https://pytest-cov.readthedocs.io/)
- [æµ‹è¯•è®¡åˆ’è¯¦ç»†æ–‡æ¡£](COMPLETE_TEST_PLAN.md)

---

**æœ€åæ›´æ–°**: 2024å¹´9æœˆ30æ—¥  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: âœ… æ ¸å¿ƒæµ‹è¯•å·²å°±ç»ª